<section class="panel">
  <div class="header">
    <h3>
      <span class="icon">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 11.5 12 4l9 7.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1z"/></svg>
      </span>
      Account info
    </h3>
    <p>Select an account to view balance and recent activity.</p>
  </div>

  <div class="account-select">
    <label>
      <span>Account</span>
      <div class="input">
        <span class="icon">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 6a2 2 0 0 1 2-2h12v4H6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12v-4H6a2 2 0 0 1-2-2z"/></svg>
        </span>
        <select
          [formControl]="accountForm.controls.rib"
          (change)="onAccountChange(accountForm.controls.rib.value ?? '')"
        >
          <option *ngFor="let acc of accounts" [value]="acc.rib">
            {{ acc.rib }}
          </option>
        </select>
      </div>
    </label>
    <button type="button" class="ghost" (click)="loadAccounts()" [disabled]="isLoading">
      {{ isLoading ? 'Refreshing...' : 'Refresh' }}
    </button>
    <a class="primary-link" routerLink="/customer/transfer">Nouveau virement</a>
  </div>

  <p class="message" *ngIf="message">{{ message }}</p>

  <div class="details" *ngIf="account">
    <div class="row">
      <span>RIB</span>
      <strong>{{ account.rib }}</strong>
    </div>
    <div class="row">
      <span>Balance</span>
      <strong>{{ account.balance | number:'1.2-2' }}</strong>
    </div>
    <div class="row">
      <span>Status</span>
      <strong>{{ account.status }}</strong>
    </div>
    <div class="row">
      <span>Customer ID</span>
      <strong>{{ account.costumerId }}</strong>
    </div>
    <div class="row" *ngIf="transactions.length">
      <span>Transactions</span>
      <strong>{{ transactions.length }}</strong>
    </div>
  </div>

  <div class="transactions" *ngIf="transactions.length">
    <div class="transactions-header">
      <h4>Transaction history</h4>
      <span>{{ transactions.length }} total</span>
    </div>
    <div class="tx" *ngFor="let tx of pagedTransactions">
      <span>{{ tx.label }}</span>
      <span>{{ tx.type }}</span>
      <strong>{{ tx.amount | number:'1.2-2' }}</strong>
      <span>{{ tx.date | date:'short' }}</span>
    </div>
    <div class="pagination">
      <button type="button" (click)="goToPage(page - 1)" [disabled]="page === 1">
        Prev
      </button>
      <span>Page {{ page }} of {{ totalPages }}</span>
      <button type="button" (click)="goToPage(page + 1)" [disabled]="page === totalPages">
        Next
      </button>
    </div>
  </div>
</section>
